<div class="favorites-page">
  <div class="favorites-header">
    <div class="header-container">
      <h1 class="page-title">
        <svg class="title-icon" viewBox="0 0 24 24">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
        </svg>
        Tus Favoritos
      </h1>
      <p class="page-subtitle">Tus propiedades guardadas para una f치cil consulta</p>
    </div>
    <button class="explore-btn" routerLink="/principal/buscarCasa">
      <svg class="btn-icon" viewBox="0 0 24 24">
        <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
      Explorar m치s
    </button>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage && !isLoading" class="error-alert">
    <svg class="alert-icon" viewBox="0 0 24 24">
      <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
    </svg>
    <span>{{ errorMessage }}</span>
  </div>

  <!-- Property Grid -->
  <div *ngIf="!isLoading && !errorMessage">
    <div *ngIf="featuredProperties && featuredProperties.length > 0; else emptyState">
      <div class="properties-grid">
        <!-- Card manteniendo tu estructura original -->
        <div *ngFor="let property of featuredProperties" class="property-card" (click)="handlePropertyClick(property.id_propiedad)">
          <div class="property-image-container">
            <img [src]="getFirstPhoto(property)" [alt]="property.titulo" class="property-image"/>
            <div class="property-overlay"></div>
            <button *ngIf="isUserLoggedIn" class="favorite-btn active" (click)="toggleFavorito(property, $event)">
              <svg viewBox="0 0 24 24">
                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
              </svg>
            </button>
            <div *ngIf="property.resenas_avg_puntuacion" class="rating-badge">
              <svg viewBox="0 0 24 24">
                <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
              </svg>
              <span>{{ property.resenas_avg_puntuacion | number:"1.1-1" }}</span>
            </div>
          </div>

          <div class="property-details">
            <h3 class="property-title">{{ property.titulo }}</h3>
            <div class="property-type">{{ property.tipo_propiedad?.nombre || "Propiedad" }}</div>
            
            <div class="property-location">
              <!-- <svg viewBox="0 0 24 24">
                <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
              </svg> -->
              游늸 <span>{{ property.ciudad }}, {{ property.pais }}</span>
            </div>

            <div class="property-features">
              <div class="feature">
                <svg viewBox="0 0 24 24">
                  <path d="M18 10V5H6v5H4v7h1.33L6 19h1l.67-2h8.67l.66 2h1l.67-2H20v-7h-2zm-8 0H8V7h2v3zm6 0h-2V7h2v3z"/>
                </svg>
                <span>{{ property.habitaciones }} hab</span>
              </div>
              <div class="feature">
                <svg viewBox="0 0 24 24">
                  <path d="M18 9h-1V4c0-1.1-.9-2-2-2H9c-1.1 0-2 .9-2 2v5H6c-1.1 0-2 .9-2 2v9c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-9c0-1.1-.9-2-2-2zM9 4h6v5H9V4zm9 15H6v-3h12v3zm0-5H6v-3h12v3z"/>
                </svg>
                <span>{{ property.banos }} ba침os</span>
              </div>
            </div>

            <div class="property-footer">
              <div class="property-owner">
                <img [src]="property.propietario?.avatar_url" alt="Propietario" class="owner-avatar"/>
                <div class="owner-info">
                  <p class="owner-name">{{ property.propietario?.first_name }} {{ property.propietario?.last_name_maternal }}</p>
                  <p class="owner-label">Propietario</p>
                </div>
              </div>
              <div class="property-price">{{ formatPrice(property.precio, property.anualizado) }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <ng-template #emptyState>
      <div class="empty-favorites">
        <div class="empty-icon">
          <svg viewBox="0 0 24 24">
            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
          </svg>
        </div>
        <h3>No tienes favoritos a칰n</h3>
        <p>Guarda propiedades que te interesen para encontrarlas f치cilmente aqu칤</p>
        <button class="discover-btn" routerLink="/principal/buscarCasa">
          <svg viewBox="0 0 24 24">
            <path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
          </svg>
          Descubrir propiedades
        </button>
      </div>
    </ng-template>
  </div>
</div>